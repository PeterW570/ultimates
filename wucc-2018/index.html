<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>UltiMates WUCC 2018</title>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link href="https://fonts.googleapis.com/css?family=Exo+2:300,400,700|Open+Sans" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.1.0/css/flag-icon.css"></link>
  <link rel="stylesheet" type="text/css" href="../common.css">
  <link rel="stylesheet" type="text/css" href="./schedule-styles.css">
  <style>
    .multi-column-list {
      display: grid;
      width: 100%;
      grid-template-columns: 1fr;
    }
    .bracket-link-list {
      display: grid;
      grid-template-columns: 1fr;
      text-align: center;
    }
    .bracket-link-list >li {
      background-color: rgba(0,0,0,0.03);
      margin: 0.5rem;
      padding: 1.2rem;
      font-size: 1rem;
    }

    @media (min-width: 500px) {
      .multi-column-list {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (min-width: 768px) {
      .multi-column-list {
        grid-template-columns: repeat(3, 1fr);
      }
      .bracket-link-list {
        grid-template-columns: repeat(3, 1fr);
      }
      .bracket-link-list >li {
        margin: 1rem;
        padding: 1.5rem;
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <a class="brand" href="../">UltiMates</a>
    <div class="links"></div>
    <span class="twitter"><i class="fab fa-twitter"></i> <a href="https://twitter.com/matesulti" target="_blank">MatesUlti</a></span>
  </header>
  <div id="app" class="container">
    <h1>Guide To WUCC 2018</h1>
    <h2 class="section-margin-top">World Ultimate Club Championships</h2>
    <span class="subtitle">14th - 21st July 2018. Cincinnati, Ohio, USA</span>

    <p class="section-margin-top">WUCC 2018 is nearly here, 128 elite teams from over 40 countries will descend on Cincinatti to battle it out to become World Champions.
       The UltiMates will be running a prediction contest, so you can get involved in the competitiveness of the tournament even if you aren't there, and will have more
        on the line when watching the livestreams! Keep an eye out on our <a href="https://twitter.com/matesulti" target="_blank">twitter feed</a> for updates and punditry.</p>

    <h3 class="section-margin-top"><a href="./fantasy">UltiMates Fantasy Competition</a></h3>
    <p class="section-margin-top-small"><span class="bold">Round 1</span> is a simple top 16 prediction, for each division. For each team, you will be awarded points based on how close
     you were to their final position, a maximum of 10 points is awarded for a correct prediction of a teams finishing position with 1 point removed for every position
     further away (e.g. If you predicted Team A to finish 8th but they instead finished 4th you would recieve 6 points, 10-4).</p>
    <p class="section-margin-top-small">In <span class="bold">Rounds 2 onwards</span>, for each game the UltiMates have created  a points spread, ie if we have Team A v Team B and we expect Team A will win
     by 2 or 3 (this is averaged over all our predictions) we will write Team A (-2.5) (This means that after the match we will take 2.5 AWAY from Team As score and then
     determine a winner) or Team B (+2.5) (this would mean ADDing 2.5 to Team Bs score). You then have to select whether you think Team A or Team B will win after these
     handicaps. If you guess correctly you win 10 points.</p>
    <p class="section-margin-top-small">To see our predictions and punditry follow <a href="./fantasy">this link</a>.</p>

    <h3 class="section-margin-top">Interactive Brackets</h3>
    <p>Note: Interactivity with pools doesn't work on some mobile devices :(</p>
    <ul class="bracket-link-list">
      <li><a href="./womens-bracket.html">Women's</a></li>
      <li><a href="./mens-bracket.html">Men's</a></li>
      <li><a href="./mixed-bracket.html">Mixed</a></li>
    </ul>

    <h3><a href="./live-schedule.html">WUCC Livestream Schedule</a></h3>
    <p>Note: This page requires a page refresh to update</p>

    <h4 class="section-margin-top-small">Current Time Slot</h4>
    <div v-show="loading">
      Loading...
    </div>
    <div v-show="!loading && liveGames.length === 0">
      No Games
    </div>
    <match-list :match-list="liveGames"></match-list>

    <h4 class="section-margin-top-small">Coming Up Next</h4>
    <div v-show="loading">
      Loading...
    </div>
    <match-list :match-list="upcomingGames"></match-list>

    <h3 class="section-margin-top">Handy Links</h3>
    <ul class="multi-column-list">
      <li><span class="bold">WUCC Official</span>
        <ul>
          <li><i class="fas fa-angle-right"></i> <a href="http://www.wucc2018.com/">Website</a></li>
          <li><i class="fas fa-angle-right"></i> <a href="http://www.wucc2018.com/Follow/Live">Livestream Schedule</a></li>
          <li><i class="fas fa-angle-right"></i> <a href="http://results.wucc2018.com/?view=games&season=WUCC2018&filter=tournaments&group=all">Live Schedule/Results</a></li>
        </ul>
      </li>
      <li><span class="bold">Live Streams</span>
        <ul>
          <li><i class="fas fa-angle-right"></i> <a href="https://www.youtube.com/user/WFDFChannel">WFDF YouTube</a></li>
          <li><i class="fas fa-angle-right"></i> <a href="https://www.facebook.com/worldflyingdisc">WFDF Facebook</a></li>
          <li><i class="fas fa-angle-right"></i> <a href="https://www.olympicchannel.com/">Olympic Channel</a></li>
          <li><i class="fas fa-angle-right"></i> <a href="https://fanseat.com/">Fanseat</a></li>
          <li><i class="fas fa-angle-right"></i> <a href="https://ultiworld.com/live">Ultiworld</a></li>
        </ul>
      </li>
      <li><span class="bold">Media Coverage</span>
        <ul>
          <li><i class="fas fa-angle-right"></i> <a href="http://ultiworld.com/tag/wucc/">Ultiworld</a></li>
          <li><i class="fas fa-angle-right"></i> <a href="http://showgame.co.uk/">The ShowGame</a></li>
          <li><i class="fas fa-angle-right"></i> <a href="https://twitter.com/matesulti">The UltiMates</a></li>
        </ul>
      </li>
    </ul>
  </div>

  <script type="text/x-template" id="match-list-template">
    <ul>
      <li class="match-list-item" v-for="match in matchList">
        <span class="time">{{ match["Time"] | localTime }}</span>
        <span class="team-1"><span :class="[flagClass(match, 1)]"></span> {{ match["Team 1"] }}</span>
        <span class="vs">v</span>
        <span class="team-2"><span :class="[flagClass(match, 2)]"></span> {{ match["Team 2"] }}</span>
        <a class="stream" :href="streamLinkForMatch(match)" target="_blank">{{ match["Stream"] }}</a>
      </li>
    </ul>
  </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.16/vue.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>

  <script>
    var publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/1kqbddiAi-NBjZGvYhXROzzFzkB0_MKiRgM_naIgEr5E/edit?usp=sharing';

    Vue.component('match-list', {
    template: '#match-list-template',
    props: ['matchList'],
    methods: {
      flagClass(match, team) {
        return 'flag-icon flag-icon-' + match['Team ' + team + ' CC'];
      },
      streamLinkForMatch(match) {
        let stream = match['Stream'];
        switch(stream) {
          case 'Ultiworld':
            return 'https://ultiworld.com/live';
          case 'Fanseat':
            return 'https://fanseat.com/';
          case 'Olympic Channel':
            return 'https://www.olympicchannel.com/';
          case 'WFDF':
            return 'https://www.youtube.com/user/WFDFChannel';
          default:
            return '';
        }
      }
    },
    filters: {
      localTime(timestamp) {
        return moment(timestamp).format("h:mma");
      },
      timeFromNow(timestamp) {
        return moment(timestamp).fromNow();
      },
      capitalize(str) {
        return str.charAt(0).toUpperCase() + str.slice(1);
      }
    }
    });

    new Vue({
    el: '#app',
    data() {
      return {
        title: 'Title',
        scheduleData: [],
        rawScheduleData: [],
        loading: true
      }
    },
    created() {
      Tabletop.init({
        key: publicSpreadsheetUrl,
        callback: this.parseDataForSchedule,
        simpleSheet: true
      });
    },
    methods: {
      parseDataForSchedule(data) {
        var parsed = {};
        data.forEach(row => {
          if (parsed[row['Day']])
            parsed[row['Day']].push(row);
          else
            parsed[row['Day']] = [row];
        });
        this.rawScheduleData = data;
        this.scheduleData = parsed;
        this.loading = false;
      }
    },
    computed: {
      upcomingGames() {
        let gamesInFuture = this.rawScheduleData.filter(d => {
          var diff = moment().diff(moment(d['Time']), 'minutes');
          return diff < 0;
        });
        return gamesInFuture.slice(0, 4);
      },
      liveGames() {
        let liveGames = this.rawScheduleData.filter(d => {
          var diff = moment().diff(moment(d['Time']), 'minutes');
          return diff > 0 && diff < 90;
        });
        return liveGames;
      }
    },
    filters: {
      prettyDay(day) {
        return moment(day).format('dddd Do MMMM');
      }
    }
    });
  </script>

</body>
</html>
